= Learning Lab Scenario 3: Gateway UI Failure
:revdate: 2025-12-11
:experimental:

[#scenario-3]
== Scenario 3: Troubleshooting AAP Gateway UI

[cols="1,3", options="header"]
|===
| **MODE** | Easy
| **Components** | Ansible Automation Platform (AAP) Gateway UI
| **Namespace** | `aap-rh1`
|===

### üéØ Objectives

* Find out why the AAP Gateway API pods are failing to start or operate.
* Log in to the AAP UI to verify that the fix was successful and the system is working again.

---

### üöÄ Initial Setup and Failure Injection

Perform the following steps to deploy the environment and inject the deliberate break.

.   **Deploy the Scenario**
    Run the following command in your lab environment and select **Scenario 3** when prompted to set up the lab components.
    [source,bash]
    ----
    ansible-playbook site.yml -t deploy
    ----

.   **Inject the Failure**
    Run the following command to introduce the issue that prevents the Gateway UI from working correctly. Again, select **Scenario 3**.
    [source,bash]
    ----
    ansible-playbook site.yml -t break
    ----

---

### üõ†Ô∏è Troubleshooting Steps

Follow these steps to diagnose and resolve the two issues in the scenario.

#### **Issue 1: Pod Failure**

.   **Diagnose the First Issue**
    Examine the logs and status of the pods within the `aap-rh1` namespace to determine why the Gateway component is failing.

[NOTE]
.Need a Hint? Click to reveal a clue.
[details,summary="Hint 1: Database Connectivity"]
----
Does the Gateway API pod have a connection to the database? Check to see if there is any network policy preventing the two from communicating.
----

.   **Apply the First Fix**
    Once you have identified the underlying cause of the first issue, run the fix playbook. Select **Scenario 3** when prompted.
    [source,bash]
    ----
    ansible-playbook site.yml -t fix
    ----

#### **Issue 2: Login Failure**

.   **Diagnose the Second Issue**
    The pods should now be running, but you may encounter an issue when attempting to log in to the AAP UI. Check the logs of the **Gateway API pod** for clues related to authentication or access.

[NOTE]
.Need a Hint? Click to reveal a clue.
[details,summary="Hint 2: Networking Resource"]
----
What OpenShift resource is needed for one pod to talk to another? Specifically, check if the Gateway API pod is able to reach the authentication service.
----

[CAUTION]
.Need Another Hint? Click to reveal a second clue.
[details,summary="Hint 3: Logs"]
----
Having issues logging in? Take a look at the Gateway API pod logs for clues like "failed to reach authentication service" or similar connection errors.
----

.   **Apply the Second Fix and Verify**
    Once you have identified the second issue, run the fix playbook again. Select **Scenario 3** when prompted, and then **verify that you can successfully log in** to the AAP Gateway UI.
    [source,bash]
    ----
    ansible-playbook site.yml -t fix
    ----